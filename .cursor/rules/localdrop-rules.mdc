---
alwaysApply: true
---
description: |
  This file defines the engineering, design, and development standards for **LocalDrop** â€” a privacy-first, client-side file converter built with Next.js 15.
  
  LocalDrop focuses on:
  - Converting files (initially HEIC to JPG) entirely in the browser.
  - Ensuring **zero server uploads** for maximum privacy.
  - Delivering a high-performance, bloat-free user experience.
  - Being **free forever**, **no-login**, and **offline-capable**.

globs:
  - "**/*.ts"
  - "**/*.tsx"
  - "**/*.js"
  - "**/*.css"
  - "next.config.ts"
  - "tailwind.config.ts"
alwaysApply: true
---

# LocalDrop: Cursor Rules & Development Standards

This is the **single source of truth** for LocalDropâ€™s engineering and design.  
Every contributor must follow these rules to ensure **privacy, performance, and memory safety**.

---

## 1. General Instructions

- Always use **sequential thinking MCP server**, **context7 MCP server**, and **memory MCP** for all planning/coding.
- Write **clean, readable, and typed TypeScript code**.  
  End every implementation with:  
  > "The written code is simple, efficient, and documented ðŸ‘Œ".
- Start each implementation phase with:  
  > "checking the current implementation â˜‘ï¸".
- Use **Cursor** for assisted implementation and **Chrome DevTools** for performance profiling and memory leak detection.

---

## 2. Task Keywords

- **Implement:** 1. Break the task into logical steps (UI -> Logic -> Optimization).  
  2. Draft a **step-by-step plan** for handling Binary Data (Blobs) and UI states.  
  3. Implement incrementally with `'use client'` directives where necessary.  
  4. Ensure proper cleanup of `URL.createObjectURL` to prevent memory leaks.  
  5. Test with large files to ensure the UI doesn't freeze.

- **Fix:** 1. List **3+ possible causes** (e.g., Browser compatibility, Memory leak, CORS/Headers).  
  2. Explain reasoning for each.  
  3. Select the most likely cause.  
  4. Write a concise fix plan.  
  5. Implement and verify.

---

## 3. Project Overview

**LocalDrop** is a **web-based utility tool** that respects user privacy by processing data locally.

Goals:
- **Privacy Core**: No file ever leaves the user's `localhost` or browser session.
- **Speed**: Instant drag-and-drop feedback.
- **MVP Scope**: HEIC to JPG/PNG conversion using `heic2any`.
- **Future Scope**: FFmpeg.wasm integration for video/audio.
- **Visuals**: Clean, trust-inducing, "utility-first" design.

---

## 4. Tech Stack

| Category               | Technology / Framework                         | Notes                                                |
|------------------------|------------------------------------------------|-----------------------------------------------------|
| **Framework** | Next.js 15 (App Router)                        | React Server Components (RSC) by default.           |
| **Language** | TypeScript                                     | Strict mode enabled.                                |
| **Styling** | Tailwind CSS                                   | Utility-first, mobile-responsive.                   |
| **Icons** | Lucide React                                   | Clean, lightweight SVG icons.                       |
| **Conversion (MVP)** | `heic2any`                                     | Specific library for HEIC blobs.                    |
| **Conversion (Future)**| `ffmpeg.wasm`                                  | For generic video/audio types.                      |
| **Deployment** | Vercel                                         | Zero-config hosting.                                |
| **State Management** | React `useState` / `useReducer`                | Keep state local to the converter component.        |

---
- **Analytics Constraint**: Do NOT install Google Analytics, Vercel Analytics, or any client-side tracking scripts. The app must remain 100% "Zero-Request" compliant to maintain user trust.

## 5. Folder Structure

```text
LocalDrop/  
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/  
â”‚   â”‚   â”œâ”€â”€ page.tsx          # Landing & Tool container  
â”‚   â”‚   â”œâ”€â”€ layout.tsx        # Global font/metadata  
â”‚   â”‚   â””â”€â”€ globals.css       # Tailwind directives  
â”‚   â”‚  
â”‚   â”œâ”€â”€ components/  
â”‚   â”‚   â”œâ”€â”€ ui/               # Reusable primitives (Buttons, Cards)  
â”‚   â”‚   â”œâ”€â”€ Converter.tsx     # Main logic component (Client Side)  
â”‚   â”‚   â””â”€â”€ DropZone.tsx      # Visual file input area  
â”‚   â”‚  
â”‚   â”œâ”€â”€ lib/  
â”‚   â”‚   â”œâ”€â”€ utils.ts          # Classname merger (clsx/tailwind-merge)  
â”‚   â”‚   â””â”€â”€ converters.ts     # Abstracted conversion logic  
â”‚   â”‚  
â”‚   â””â”€â”€ hooks/  
â”‚       â””â”€â”€ use-worker.ts     # Future: WebWorker management  
â”‚  
â”œâ”€â”€ public/                   # Static assets  
â”œâ”€â”€ next.config.ts            # Header config for SharedArrayBuffer  
â””â”€â”€ package.json
6. Coding Conventions
Component Structure:

Use export default function ComponentName() {}.

Separate Logic (useConverter) from UI (return ...) where possible.

Client vs Server:

By default, use Server Components.

Add 'use client' only to the leaf components handling drag-and-drop or browser APIs.

Memory Safety:

ALWAYS revoke Blob URLs: URL.revokeObjectURL(url) when the component unmounts or file changes.

Type Safety:

No any. Define interfaces for File props and Conversion options.

7. Animations & UI Design
Aesthetic: "Functional Brutalism" or "Clean SaaS".

High contrast text (Slate-900).

Subtle borders (Slate-200).

Clear "Action" colors (Blue-600 or Black).

Feedback:

Loading: Spinner inside the button during conversion.

Success: Animate in the "Download" button (Scale/Fade).

Error: Red border/toast on the DropZone if file type is wrong.

Responsive:

Stack vertically on mobile.

Expand drag area on desktop.

8. Browser & Security Constraints
Headers:

If using ffmpeg.wasm in future, Cross-Origin-Opener-Policy: same-origin and Cross-Origin-Embedder-Policy: require-corp are REQUIRED in next.config.ts.

File Limits:

For MVP (Main thread), cap files at ~50MB to prevent UI freeze.

Warn user if file is too large.

9. Ignored Files
Plaintext

.next/
node_modules/
.env
.env.local
npm-debug.log*
.DS_Store
10. Marketing & Landing Page
Headline: "Convert HEIC to JPG. Offline. Private. Free."

Sub-headline: "Your photos never leave your browser. The only converter that doesn't track you."

SEO: Meta tags must target "HEIC to JPG converter", "Free offline converter", "iPhone photo converter".

Trust Signals: "Open Source", "Client-side only", "No Signup".

11. Development Principles
Trust over Features â€” If a feature requires uploading data (e.g., "Email me the file"), kill the feature.

Performance over Pretty â€” The conversion speed is the primary metric.

Simplicity â€” One button, one result. No "Advanced Settings" dropdowns for the MVP.

Zero Cost â€” Use libraries and hosting that fit within free tiers (Vercel Hobby, GitHub Pages).

